<script src="/socket.io/socket.io.js"></script>
<script src="js/clientside_groupchat.js"></script>
<script src="js/clientside_notes.js"></script>
<script src="js/clientside_agenda.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code
.jquery.com/ui/1.10.3/jquery-ui.js"></script>

<script>
var socket = io.connect('http://localhost:4000');

var newChat = ChatClient();
newChat.init(socket);

var notebook = NoteClient();
notebook.init(socket)

var agenda = AgendaClient();
agenda.init(socket);

	$(function(){

		// when the client clicks SEND
		$('#enterchat').click( function() {
			console.log("button pressed");
			var message = $('#chatdata').val();
			$('#chatdata').val('');
			// tell server to execute 'sendchat' and send along one parameter
			newChat.sendMessage(message);
		});

		// when the client hits ENTER on their keyboard
		$('#enterchat').keypress(function(e) {
			if(e.which == 13) {
				$(this).blur();
				$('#chatdata').focus().click();
			}
		});

		$('#notesarea').keyup(function() {
			var notes = $('#notesarea').val();
			setTimeout(notebook.updateNotes(notes), 5000);
		});

	});

	newChat.joinChat = function(chatlog) {
		for(var i = 0; i < chatlog.length; i++) {
			$('#conversation').append('<b>'+ chatlog[i].username + ':</b> ' + chatlog[i].messageData + '<br>');
		}
	};
	newChat.displayChat = function(username, message) {
		console.log("displaying chat");
		$('#conversation').append('<b>'+ username + ':</b> ' + message + '<br>');
	};

	notebook.clientNoteStamp = function() {
		$('#timestamp').text("Saved.");
		setTimeout(function() {
		$('#timestamp').text("Saved less than a minute ago.")
		}, 10000);
		setTimeout(function() {
			$('#timesta	mp				z').text("Saved about a minute ago.")
		}, 60000);
		setTimeout(function() {
			$('#timestamp').text("Saved more than 2 minutes ago")
		}, 120000);

	};
	agenda.createAgenda = function(topics) {
		console.log(topics);
		for(var i = 0; i < topics.length; i++) {
			$('#topicList').append("<li id=\'agenda-li" + i + "\'class='agenda-item'></li>");
			$('#agenda-li' + i).append("<div id=\'topic" + i + "\'>" + topics[i] + "</div");
		}
	};

</script>
<html>
	<head>

		<title>Wastewise</title>

		<style>
			body {
				margin:0;
				padding:0;
			}
			#header {
				width:100%;
				height:50px;
				background-color:green;
			}
			#agenda {
				height:414px;
				width:14.5%;
				border:1px solid black;
				float:left;
			}
			#notes {
				float:left;
				height:414px;
				width:15%;
				border:1px solid black;
			}
			#notes textarea {
				height:300px;
				width:100%;
				resize: none;
			}
			#video {
				width:40%;
				height:415px;
				float:left;
				margin-left:2px;
			}
			#qa {
				width:15%;
				height:414px;
				float:right;
				border:1px solid black;
			}
			#chatroom {
				width:14.5%;
				height:414px;
				float:right;
				border:1px solid black;
			}
			#conversation {
				height:100px;
				overflow:auto;
				border:1px solid black;
			}
			#agenda ul {
				list-style:none;
			}
			.agenda-item {
				width:100px;
				height:50px;
				margin:10px;
				background-color:red;
				color:white;
			}
		</style>
	</head>

	<body>
		<div id='header'> <%= username %></div>
		<div id='agenda'>
			<h3>Agenda</h3>
			<ul id='topicList'>
			
			</ul>
		</div>


		<div id='notes'>
			<h3>Notes</h3>
			<textarea id="notesarea"style='width:100%; height:320px'></textarea>
			<div id='timestamp'></div>
		</div>

		<div id='video'><iframe width="100%" height="100%" src="//www.youtube.com/embed/RAJgGIQ3JHk" frameborder="0" allowfullscreen></iframe></div>

		<div id='qa'>
			<h3>QA</h3>
		</div>

		<div id='chatroom'>
			<h3>Chatroom</h3>
			<input id="chatdata" style="width:100px;" />
			<input type="button" id="enterchat" value="send" />
			<div id="conversation"></div>
			<div id="users"></div>
		</div>

	</div>

	</body>

</html>

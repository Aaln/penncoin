<script src="/socket.io/socket.io.js"></script>
<script src="js/clientside_groupchat.js"></script>
<script src="js/clientside_notes.js"></script>
<script src="js/clientside_agenda.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code
.jquery.com/ui/1.10.3/jquery-ui.js"></script>

<script>
var socket = io.connect('http://localhost:4000');

var newChat = ChatClient();
newChat.init(socket);

var notebook = NoteClient();
notebook.init(socket)

var agenda = AgendaClient();
agenda.init(socket);

	$(function(){
		/**
		var dynamo = function() {
		var windowWidth = $(window).width();
		var leftBarWidth = $('#leftBar').css({'width'});
		var rightBarWidth = $('#rightBar').css({'width'});
		var videoWidth = $('#video').css({'width'});
		if(windowWidth < 1279) {

		};
	};*/


		$('#agenda-tab').click( function() {
			if($('#notes').css('display') === 'block') {
				$('#notes').css({'display':'none'});
				$('#agenda').css({'display': 'block'});
			}
			else {
				$("#notes").css({'display':'block'});
				$('#agenda').css({'display': 'none'});
			};

		});
		$('#chat-tab').click( function() {
			if($('#chatroom').css('display') === 'none' ) {
				$('#qa').css({'display':'none'});
				$('#chatroom').css({'display':'block'});
			}
		});

		$('#qa-tab').click( function() {
			if($('#qa').css('display') === 'none') {
				$('#chatroom').css({'display':'none'});
				$('#qa').css({'display':'block'});
			}
		});
		// when the client clicks SEND
		$('#enterchat').click( function() {
			var message = $('#chatdata').val();
			$('#chatdata').val('');
			// tell server to execute 'sendchat' and send along message as parameter
			newChat.sendMessage(message);
		});

		// when the client hits ENTER on their keyboard
		$('#enterchat').keypress(function(e) {
			if(e.which == 13) {
				$(this).blur();
				$('#chatdata').focus().click();
			}
		});

		//send and save notes after 5 second after user stops typing
		//5 second timer doesn't work...
		var stoppedTyping;
		$('#notesarea').keypress(function() {
			var notes = $('#notesarea').val();
			if (stoppedTyping) clearTimeout(stoppedTyping);

			stoppedTyping = setTimeout(notebook.updateNotes(notes), 5000);
		});



	});

	newChat.joinChat = function(chatlog) {
		for(var i = 0; i < chatlog.length; i++) {
			$('#conversation').append('<b>'+ chatlog[i].username + ':</b> ' + chatlog[i].messageData + '<br>');
		}
	};
	newChat.displayChat = function(username, message) {
		$('#conversation').append('<b>'+ username + ':</b> ' + message + '<br>');
	};

	notebook.clientNoteStamp = function() {
		$('#timestamp').text("Saved.");
		setTimeout(function() {
		$('#timestamp').text("Saved less than a minute ago.")
		}, 10000);
		setTimeout(function() {
			$('#timesta	mp				z').text("Saved about a minute ago.")
		}, 60000);
		setTimeout(function() {
			$('#timestamp').text("Saved more than 2 minutes ago")
		}, 120000);

	};
	agenda.createAgenda = function(topics) {
		console.log(topics);
		for(var i = 0; i < topics.length; i++) {
			$('#topicList').append("<li id=\'agenda-li" + i + "\'class='agenda-item'></li>");
			$('#agenda-li' + i).append("<div id=\'topic" + i + "\'>" + topics[i] + "</div");
		}
	};

</script>
<html>
	<head>

		<title>Wastewise</title>

		<style>
			body {
				margin:0;
				padding:0;
			}
			#header {
				width:100%;
				height:70px;
				border:2px solid white;
				background-color:#f2f6fc;
			}
			#header h1 {
				color: #404040;
				text-align: center;
			}
			#leftBar {
				background-color:#edf0f1;
			 	float:left;
			 	height:414px;
			 	width:20%;
			 	border:2px solid white;
			}
			#rightBar {
				background-color:#edf0f1;
				float:right;
				height:414px;
				width:20%;
				border:2px solid white;
			}
			#video {
				width:58%;
				height:415px;
				float:left;
				margin-right:5px;
			}
			#video iframe {
				width:100%;
				height:414px;
				margin:0px 10px 0px 10px;
			}
			#conversation {
				height:100px;
				overflow:auto;
				border:1px solid black;
			}
			.agenda-item {
				width:100%;
				height:50px;
				margin:0;
				background-color:red;
				color:white;
			}
			#agenda ul {
				padding:0;
				list-style: none;
			}
			#agenda ul li {
				margin:10px;
			}

			#agenda-tab {
				width:100%;
				height:40px;
				background-color:blue;
				opacity:.6;
			}

			#notes-tab {
				width:100%;
				height:40px;
				background-color: red;
				opacity: .6;
			}

			#tab-text {
				color:white;
				font-size: 30px;
				font-family: awesome;
				padding:20px 0 0 50%;
			}
			#thisAgenda {
				height:75px;
				width:100%;
				background-color:green;
			}
			#notes {
				height:300px;
				width:100%;
				display:block;
			}
			#notes textarea {
				height:260px;
				width:100%;
				resize:none;
				background-color: #fff;
				font-size:16px;
			}
			#agenda {
				height:260px;
				width:100%;
				background-color:yellow;
				display: none;
			}
			#chat-tab {
				height:40px;
				width:50%;
				background-color:red;
				float:left;
			}
			#qa-tab {
				height:40px;
				width:50%;
				background-color:blue;
				float:left;
			}
			#chatroom {
				height:360px;
				width:100%;
				background-color: red;
				display:none;
			}
			#conversation {
				height:300px;
				width:180px;
				border:2px solid black;
				border-radius: 5px;
				background-color: #fff;
				margin-left:10px;
			}
			#qa {
				height:360px;
				width:100%;
				background-color:blue;
				display:block;
			}


			::-webkit-scrollbar {
    		-webkit-appearance: none;
    		width: 7px;
			}

			::-webkit-scrollbar-thumb {
    		border-radius: 4px;
    		background-color: rgba(0,0,0,.5);
    		-webkit-box-shadow: 0 0 1px rgba(255,255,255,.5);
			}
		</style>
	</head>

	<body>
		<div id='header'>
			<h1>WasteWise Roundtable</h1>
		</div>

		<div id='leftBar'>
			<div id='agenda-tab'><span id='tab-text'>Agenda</span></div>
			<div id='thisAgenda'></div>
			<div id='agenda'>
				<ul id='topicList'></ul>
			</div>
			<div id='notes-tab'><span id='timestamp'></span><span id='tab-text'>Notes</span></div>
			<div id='notes'><textarea id='notesarea'></textarea></div>
			

		</div>

		<!--<div id='agenda'>
			<h3>Agenda</h3>
			<ul id='topicList'>
			
			</ul>
		</div>
		<div id='notes'>
			<h3>Notes</h3>
			<textarea id="notesarea"style='width:100%; height:320px'></textarea>
			<div id='timestamp'></div>
		</div>
	-->

		<div id='video'><iframe src="//www.youtube.com/embed/RAJgGIQ3JHk" frameborder="0" allowfullscreen></iframe></div>

		<div id='rightBar'>
			<div id='chat-tab'>chat</div>
			<div id='qa-tab'>QA</div>
			<div id='chatroom'>
				<div id='conversation'></div>
				<input id='chatdata' />
				<input id='enterchat' type='button' value='send' />
			</div>
			<div id='qa'></div>
		</div>
		<!--
		<div id='chatroom'>
			<h3>Chatroom</h3>
			<input id="chatdata" style="width:100px;" />
			<input type="button" id="enterchat" value="send" />
			<div id="conversation"></div>
			<div id="users"></div>
		</div> -->

	</div>

	</body>

</html>
